{% extends 'base.html' %}
{% block head %}
    <title>{{ item.name }} | Antlers</title>
    <meta name="description" content="{{ item.description }}">
    <meta property="og:title" content="{{ item.name }} | Antlers">
    <meta property="og:description" content="{{ item.description }}">
    <meta property="og:image" content="{{ url_for('static', filename='uploads/' + item.image) }}">
    <meta property="og:url" content="{{ request.url }}">
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Product",
      "name": "{{ item.name|e }}",
      "description": "{{ item.description|e }}",
      "image": "{{ url_for('static', filename='uploads/' + item.image, _external=True) }}",
      "offers": {
        "@type": "Offer",
        "availability": "{{ 'https://schema.org/InStock' if item.is_available else 'https://schema.org/OutOfStock' }}",
        "price": "0",
        "priceCurrency": "INR"
      }
    }
    </script>
{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-10">
            <div class="card shadow-lg border-0 rounded-4">
                <div class="row g-0">
                    <div class="col-md-5 d-flex align-items-center justify-content-center bg-light rounded-start-4">
                        <img src="{{ url_for('static', filename='uploads/' + item.image) }}" alt="{{ item.name }}" class="img-fluid rounded-4 p-3" style="max-height: 400px; object-fit: contain; background: #fff;">
                    </div>
                    <div class="col-md-7 p-4">
                        <h1 class="display-5 fw-bold mb-3">{{ item.name }}</h1>
                        <div class="mb-3">
                            <span class="badge bg-primary me-2">{{ item.category }}</span>
                            <span class="badge bg-secondary">{{ item.type|capitalize }}</span>
                        </div>
                        <p class="lead mb-4">{{ item.description }}</p>
                        <ul class="list-unstyled mb-4">
                            <li><i class="fas fa-map-marker-alt me-2 text-danger"></i><strong>Location:</strong> {{ item.location }}</li>
                            <li><i class="fas fa-check-circle me-2 text-success"></i><strong>Available:</strong> {{ 'Yes' if item.is_available else 'No' }}</li>
                        </ul>
                        <div class="mt-4">
                            <a href="/home" class="btn btn-outline-primary rounded-pill px-4 me-2"><i class="fas fa-arrow-left me-2"></i>Back to Items</a>
                            <a href="{{ url_for('borrow_item', item_id=item.id) }}" class="btn btn-primary rounded-pill px-4"><i class="fas fa-envelope me-2"></i>Contact Owner</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mt-5">
                <h3 class="mb-4">Related Items in {{ item.category }}</h3>
                {% if related_items and related_items|length > 0 %}
                <div class="row">
                    {% for related in related_items %}
                    <div class="col-md-3 mb-4">
                        <div class="card h-100 border-0 shadow-sm">
                            <a href="{{ url_for('item_detail', slug=related.slug) }}" class="text-decoration-none">
                                <img src="{{ url_for('static', filename='uploads/' + related.image) }}" class="card-img-top rounded-top" alt="{{ related.name }}" style="height: 180px; object-fit: cover;">
                                <div class="card-body">
                                    <h5 class="card-title mb-2">{{ related.name }}</h5>
                                    <p class="card-text text-muted small">{{ related.description[:60] }}{% if related.description|length > 60 %}...{% endif %}</p>
                                </div>
                            </a>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <div class="alert alert-info">There are no related items in this category.</div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %} 